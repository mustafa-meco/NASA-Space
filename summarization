import spacy
from spacy.lang.en.stop_words import STOP_WORDS
from string import punctuation

# Defining the stop words and punctuation to be excluded from word scoring
STOPWORDS = list(STOP_WORDS)
PUNCTUATION = punctuation + '\n'


def calc_word_freq(doc):
    word_frequencies = {}
    for word in doc:
        if word.text.lower() not in stopwords and word.text.lower() not in punctuation:
                if word.text.lower() not in word_frequencies.keys():
                    word_frequencies[word.text.lower()] = 1
                else:
                    word_frequencies[word.text.lower()] += 1
    
    return word_frequencies

def Summarize(text):

    nlp = spacy.load('en_core_web_sm')
    doc = nlp(text)

    tokens = [ token.text for token in doc]

    word_frequencies = calc_word_freq(doc)
    


    
    

